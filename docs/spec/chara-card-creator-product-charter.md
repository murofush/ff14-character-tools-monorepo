# Chara Card Creator プロダクト定義

## ステータス

- 状態: Draft
- 決定日: 2026-02-07

## 目的/背景

- `chara-card-creator` は FF14 プレイヤーの Lodestone 情報を起点に、SNS 共有向けのキャラカードを作成するためのプロダクトである。
- 現在は React 移行途中であり、旧 Vue/Nuxt 実装と React 実装が同居している。
- 実装優先で移行すると「何を完成状態とするか」が曖昧になりやすいため、先にプロダクトの責務と範囲を定義する。

## 仕様

1. Product Charter（何を実現するか）
- 対象ユーザー:
  - FF14 のキャラクター情報を使って、短時間で見栄えのある自己紹介カードを作りたいプレイヤー。
- 解決する課題:
  - プロフィール作成に必要な情報収集・整形・画像化の手間を削減する。
- 提供価値:
  - Lodestone URL/ID 入力から、アチーブメント反映済みカード作成までを一連フローで提供する。

2. IA / 画面責務
- `/`（Home）:
  - Lodestone URL/ID の入力と検証。
  - 取得済みキャラクターから作成再開する導線。
  - 作成手順（つかいかた）の提示。
- `/select-achievement`:
  - 取得済みアチーブメントから、カードに載せる要素を選択する。
- `/edit-chara-card`:
  - 文字情報・配色・フォント・画像レイアウトを編集し、カードを仕上げる。
- `/about`:
  - サービス概要・注意事項を提示する。

3. 機能スコープ
- Must（本プロダクトの成立条件）:
  - Lodestone URL/ID 入力検証と正規化。
  - キャラクター情報の取得と表示。
  - アチーブメント選択（上限管理含む）。
  - キャラカード編集（基本テキスト、画像、テーマ）。
  - 旧互換ルート維持（`/editCharaCard`, `/selectAchievement`）。
- Should（次段で対応する価値向上）:
  - 再訪時の復元（ローカル保存）改善。
  - 入力エラーの分類表示（ユーザー入力 / ネットワーク / 取得先障害）。
  - 編集プリセット（テーマ・フォントセット）の拡充。
- Out（この仕様では扱わない）:
  - ユーザーアカウント/サーバ保存。
  - 課金・権限管理。
  - `achievement-editor` との機能統合。

4. 受け入れ条件（機能定義）
- Home で URL/ID の妥当性判定ができること。
- 選択画面でアチーブメント選択数の制約が機能すること。
- 編集画面でカード編集結果が視覚的に確認できること。
- 互換ルートから新ルートへ正しく遷移できること。

5. 手動チェック観点
- `/` で空入力・不正入力・正常入力の挙動が区別される。
- `/select-achievement` で選択/解除、上限到達時の挙動が確認できる。
- `/edit-chara-card` で編集内容が反映される。
- `/editCharaCard` と `/selectAchievement` が新ルートへリダイレクトされる。

6. 移行境界（旧資産との線引き）
- 主系実装は `apps/chara-card-creator/src` とする。
- 旧 Vue/Nuxt 資産は、対応機能が React 側で受け入れ条件を満たすまで削除しない。
- 1機能移行ごとに AI-TDD（Red→Green→Refactor）で同等性を検証する。

## 受け入れ条件

- 本仕様を参照して、機能単位で「Must/Should/Out」の判定ができる。
- React 移行タスクで、対象画面の責務と移行境界を明確に説明できる。
- `pnpm --filter @ff14/chara-card-creator build` が継続して成功する。

## 非ゴール

- 実装詳細（コンポーネント分割粒度、状態管理ライブラリ最終選定）の固定化。
- UI全面刷新。
- 旧資産の即時一括削除。

## 影響範囲

- Front: `apps/chara-card-creator/src` の画面責務・機能優先順位の整理。
- Back: 旧 API 取得経路の段階移行方針の明確化。
- Domain: キャラクター情報・アチーブメント情報・カード編集データの扱い定義。
- Infra: 既存ビルド検証コマンドの継続運用。
- Docs: 本仕様、索引、TODO。

## 既存挙動との差分

- 既存は「移行途中の画面実装」が中心で、プロダクト成立条件の明文化が不足していた。
- 本仕様により、画面責務・機能スコープ・移行境界を先に固定して実装判断できるようにする。

## 移行/互換方針

- 互換期間中は旧 URL を React Router 側で吸収する。
- 実装は機能単位で段階移行し、同等性検証完了後に旧資産を削除する。
- 破壊的変更は 1 機能ずつ分離し、ロールバック可能性を維持する。

## 関連リンク

- `docs/spec/README.md`
- `docs/spec/chara-card-creator-react-staged-migration.md`
- `apps/chara-card-creator/src/app/App.tsx`
- `apps/chara-card-creator/AGENTS.md`
