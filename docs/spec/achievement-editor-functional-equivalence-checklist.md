# Achievement Editor 機能同等チェックリスト（旧実装基準）

## ステータス

- 状態: Confirmed
- 決定日: 2026-02-07

## 目的/背景

- React 移行時に「機能だけ完全移植」を判定するため、旧実装基準の確認項目を明文化する。
- UI見た目の差異は許容し、操作結果・保存結果・副作用の同等性を評価対象とする。

## 仕様

1. 評価方針
- 判定単位は画面/操作/期待結果。
- 期待結果には UI 表示だけでなく、データ状態・API 呼び出し・保存結果を含める。
- 各項目は以下で評価する。
  - `未着手`
  - `実装済`
  - `手動確認済`
  - `差分あり（要仕様合意）`

2. 前提条件
- 初期データ（Tag/Patch/Achievement）を Cloud Storage からロードできること。
- 保存 API（`POST /api/save_text`）を呼び出せること。
- Lodestone補助取得 API（`/api/get_hidden_achievement`, `/api/get_icon_img`, `/api/get_item_infomation`）を呼び出せること。

## 受け入れ条件

- Must 項目がすべて `手動確認済` である。
- 差分項目がある場合、仕様書に事前合意が記録されている。

## 非ゴール

- Vuetify 固有DOMや見た目の一致。
- 旧コード構造のコピー。

## 影響範囲

- Front / Back / Domain / Docs（移行判定全体）

## 既存挙動との差分

- なし（旧実装の確認観点を明文化したもの）。

## 移行/互換方針

- 本チェックリストを満たさない状態で旧実装を削除しない。
- 差分が必要な場合は仕様変更を先に確定する。

## チェックリスト

### A. 共通レイアウト・遷移

- [ ] `KIND` ベースのカテゴリ導線が表示される。
- [ ] `/tag` と `/patch` 導線が表示される。
- [ ] ログイン表示領域（未ログイン/ログイン済）が機能する。
- [ ] 共通スナックバーで成功/失敗メッセージを表示できる。

### B. 初期ロード

- [ ] 初回アクセス時に Tag/Patch/Achievement がロードされる。
- [ ] 同一セッション内の二重ロード抑止（isLoaded）が機能する。

### C. カテゴリ編集ページ（9画面共通）

- [ ] 該当 `key` のデータのみを編集対象として表示できる。
- [ ] カテゴリ単位で未保存差分が検知される。
- [ ] カテゴリ単位保存が成功し、差分状態が解消される。
- [ ] テーブル全体保存が全カテゴリ保存として機能する。

### D. グループ作成/編集

- [ ] グループ作成時にタイトル必須チェックが動作する。
- [ ] 同名グループ重複がエラー通知される。
- [ ] グループ名編集（ダイアログ）が反映される。
- [ ] グループ削除時に子アチーブメントが未分類へ戻る。

### E. アチーブメント作成

- [ ] 手入力作成で必須バリデーションが動作する。
- [ ] 作成時に既定初期値（sourceIndex=-1, tagIds=[], patchId=0 等）が付与される。
- [ ] タイトル報酬（共通/男女別）の条件入力が機能する。
- [ ] アイテム報酬の条件入力が機能する。
- [ ] `isLatestPatch` が保持される。

### F. Lodestone補助取得

- [ ] `AchievementURL` から `/api/get_hidden_achievement` 取得が機能する。
- [ ] アイコンURLから `/api/get_icon_img` 取得が機能する。
- [ ] アイテムURLから `/api/get_item_infomation` 取得が機能する。
- [ ] 取得失敗時にエラー通知が表示される。

### G. タグ/パッチ割当（itemsEditor）

- [ ] グループ単位タグ設定が全子アチーブメントへ反映される。
- [ ] 個別タグ設定が単一アチーブメントへ反映される。
- [ ] グループ単位パッチ設定（対応/緩和）が全子へ反映される。
- [ ] 個別パッチ設定（対応/緩和）が単一へ反映される。

### H. 並び替え

- [ ] 未分類データの並びが `sourceIndex` で整列される（-1は末尾）。
- [ ] 分類済データの並びが `sourceIndex` で整列される（-1は末尾）。
- [ ] グループ並び替えが保持される。

### I. タグ管理（/tag）

- [ ] タグ追加時にID/名称必須と重複チェックが機能する。
- [ ] ネストタグを含む削除・並び替えが機能する。
- [ ] 保存で `/api/save_text` が呼ばれ、差分状態が解消する。
- [ ] `isForceTagUpdate` ON時に tagId 再採番とアチーブメント追従が機能する。

### J. パッチ管理（/patch）

- [ ] パッチ追加時にID/番号/日付/対象バージョン検証が機能する。
- [ ] 保存で `/api/save_text` が呼ばれ、差分状態が解消する。
- [ ] `isForcePatchUpdate` ON時に patchId 再採番とアチーブメント追従が機能する。
- [ ] パッチ更新後のアチーブメント保存導線が機能する。

### K. 保存失敗時挙動

- [ ] タグ保存失敗時にエラー通知される。
- [ ] パッチ保存失敗時にエラー通知される。
- [ ] カテゴリ保存失敗時にエラー通知される。

## 関連リンク

- `docs/spec/achievement-editor-product-charter.md`
- `docs/spec/achievement-editor-legacy-screen-responsibilities.md`
- `docs/spec/achievement-editor-legacy-api-data-contract.md`
- `apps/achievement-editor/pages/`
- `apps/achievement-editor/components/`
